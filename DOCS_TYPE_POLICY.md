# Типовая дисциплина и документация типов

Обновлено: 03.11.2025

## Принципы
- Строгие интерфейсы вместо `Record<string, unknown>` в домене.
- Политика null: отсутствующие значения как `null`, не `undefined`.
- `exactOptionalPropertyTypes`: опциональные поля не содержат `undefined` на use-site.
- Комментарии к каждому публичному типу/интерфейсу обязательны (JSDoc).
- Утверждения типов и `any` запрещены; допускаются только в явно задокументированных временных заглушках (TYPE_USAGE.md).

## Документация типов (пример)
```ts
/** Пользователь платформы, доменная модель. */
export interface User { /* ... */ }

/** Настройки уведомлений пользователя. */
export interface NotificationSettings { /* ... */ }

/** Предпочтения пользователя (UI/локаль/уведомления). */
export interface UserPreferences { /* ... */ }

/** Игровая/чтение статистика пользователя. */
export interface UserStats { /* ... */ }
```

## JSONB-поля (preferences/stats)
- В домене — строгая структура `UserPreferences` и `UserStats`.
- В репозитории — преобразование JSONB ↔ строгий тип; при отсутствии полей — подстановка дефолтов.

## exactOptionalPropertyTypes — правила
- Входные DTO собираем условными спредами:
```ts
const dto = {
  required: x,
  ...(optional !== undefined && { optional }),
} as const;
```
- Никаких полей со значением `undefined` в передаваемых объектах.

## Комментарии к коду
- Публичные типы, функции сервиса, репозитории, события — с JSDoc.
- Указывать назначение, инварианты, ожидаемые побочные эффекты.

## Контроль
- Линт-правила и typecheck на PR.
- Ревью проверяет JSDoc и соответствие типовой дисциплине.
